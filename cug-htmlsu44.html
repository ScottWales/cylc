<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Asynchronous Tasks</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- xhtml,3,next,html --> 
<meta name="src" content="cug-html.tex" /> 
<meta name="date" content="2011-08-15 17:29:00" /> 
<link rel="stylesheet" type="text/css" href="cug-html.css" /> 
</head><body 
>
   <!--l. 3376--><div class="crosslinks"><p class="noindent">[<a 
href="cug-htmlsu45.html" >next</a>] [<a 
href="cug-htmlse10.html" >prev</a>] [<a 
href="cug-htmlse10.html#tailcug-htmlse10.html" >prev-tail</a>] [<a 
href="#tailcug-htmlsu44.html">tail</a>] [<a 
href="cug-htmlse10.html#cug-htmlsu44.html" >up</a>] </p></div>
   <h4 class="subsectionHead"><span class="titlemark">10.1   </span> <a 
 id="x67-10900010.1"></a>Asynchronous Tasks</h4>
<!--l. 3379--><p class="noindent" ><span 
class="cmti-10">Introduced at version </span>3<span 
class="cmmi-10">.</span>4<span 
class="cmmi-10">.</span>0
</p><!--l. 3381--><p class="indent" >   Cylc now has <span 
class="cmti-10">one-off asynchronous tasks </span>for constructing one-off suites of tasks that have no associated cycle
time, and <span 
class="cmti-10">repeating asynchronous tasks </span>for processing satellite passes (these propagate a special &#8220;data ID&#8221;
through the task tree, and can process consecutive passes in parallel if the data happens to come in
quickly).
</p><!--l. 3388--><p class="indent" >   Asynchronous tasks have an arbitrary integer tag instead of a cycle time. Cylc can manage both asynchronous
and cycling tasks within the same suite.
</p><!--l. 3392--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">10.1.1   </span> <a 
 id="x67-11000010.1.1"></a>One-off Asynchronous Tasks</h5>
<!--l. 3394--><p class="noindent" >These tasks are defined with no sub-heading under [dependencies] in the suite.rc file:
</p>
   <!--l. 3397-->
   <div class="lstlisting" id="listing-82"><span class="label"><a 
 id="x67-110001r1"></a></span><span 
class="pcrro7t-">#</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">SUITE</span><span 
class="pcrro7t-">.</span><span 
class="pcrro7t-">RC</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x67-110002r2"></a></span><span 
class="pcrr7t-">[</span><span 
class="pcrr7t-">dependencies</span><span 
class="pcrr7t-">]</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x67-110003r3"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">graph</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">"</span><span 
class="pcrr7t-">foo</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">=&#x003E;</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">bar</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">=&#x003E;</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">baz</span><span 
class="pcrr7t-">"</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x67-110004r4"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">[[0,12]]</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x67-110005r5"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">graph</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">"</span><span 
class="pcrr7t-">baz</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">=&#x003E;</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">CyclingA</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">=&#x003E;</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">CyclingB</span><span 
class="pcrr7t-">"</span>
   
   </div>
<!--l. 3405--><p class="indent" >   In this listing two cycling tasks are made to wait on a chain of three one-off asynchronous tasks
(they can be used in entirely non-cycling suites, or for initial processing prior to starting the cycling
tasks).
                                                                                         

                                                                                         
</p><!--l. 3409--><p class="noindent" >
</p>
<!--l. 3409--><p class="noindent" ><span class="paragraphHead"><a 
 id="x67-11100010.1.1.1"></a><span 
class="cmbx-10">C.f. One-off Synchronous &#8220;startup&#8221; Tasks</span></span>
   One-off synchronous startup tasks run only when a cycling suite is <span 
class="cmti-10">cold started </span>and they are often associated
with subsequent one-off <span 
class="cmti-10">cold start tasks </span>used to bootstrap a cycling suite into existence.
</p><!--l. 3415--><p class="indent" >   The distinction between cold and warm start is only meaningful for cycling tasks, and one-off asynchronous tasks
may be best used in constructing entirely non-cycling suites.
</p><!--l. 3419--><p class="indent" >   However, one-off asynchronous tasks can precede cycling tasks in the same suite, as shown above. It seems likely
that, if used in this way, they will be intended as startup tasks - so currently they will only run in a cold start. For
completeness though, in a future release we will make it possible to have one-off asynchronous in a cycling suite that
run even if the suite is warm started.
</p><!--l. 3426--><p class="noindent" >
</p>
<!--l. 3426--><p class="noindent" ><span class="paragraphHead"><a 
 id="x67-11200010.1.1.2"></a><span 
class="cmbx-10">One-off Asynchronous Example Suite</span></span>
   See suite <span class="lstinline"><span 
class="pcrr7t-">[</span><span 
class="pcrr7t-">admin</span><span 
class="pcrr7t-">]:</span><span 
class="pcrr7t-">examples</span><span 
class="pcrr7t-">:</span><span 
class="pcrr7t-">async_oneoff</span></span>
</p><!--l. 3430--><p class="noindent" >
</p>
   <h5 class="subsubsectionHead"><span class="titlemark">10.1.2   </span> <a 
 id="x67-11300010.1.2"></a>Repeating Asynchronous Tasks</h5>
<!--l. 3432--><p class="noindent" >These tasks can be used to construct suites for processing asynchronous satellite datasets, wherein the data arrives
at (effectively) random intervals. The first task in the suite should be of the <span 
class="cmti-10">daemon </span>type, which runs indefinitely
watching for incoming data. When new data is detected it sends a message that matches a registered pattern
containing some unique data ID. The daemon task proxy extracts the ID and dynamically registers a new output,
containing the actual ID, that downstream tasks can trigger off. The downstream tasks likewise have prerequisites
containing the pattern, and when these are satisfied the actual ID is substituted into their registered outputs. Each
asynchronous task proxy passes the ID to its real task as <span class="lstinline"><span 
class="pcrr8c-">$</span><span 
class="pcrr7t-">ASYNCID</span></span> so that it can process the correct dataset.
Repeating asynchronous tasks are defined under special sub-headings in the [dependencies] section of the suite.rc
graph, e.g.:
</p>
   <!--l. 3447-->
   <div class="lstlisting" id="listing-83"><span class="label"><a 
 id="x67-113001r1"></a></span><span 
class="pcrro7t-">#</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">SUITE</span><span 
class="pcrro7t-">.</span><span 
class="pcrro7t-">RC</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x67-113002r2"></a></span><span 
class="pcrr7t-">[</span><span 
class="pcrr7t-">dependencies</span><span 
class="pcrr7t-">]</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x67-113003r3"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">[[</span><span 
class="pcrr7t-">ASYNCID</span><span 
class="pcrr7t-">:</span><span 
class="pcrr7t-">SATID</span><span 
class="pcrr7t-">-\</span><span 
class="pcrr7t-">d</span><span 
class="pcrr7t-">+]]</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x67-113004r4"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">graph</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">"</span><span 
class="pcrr7t-">watcher</span><span 
class="pcrr7t-">:</span><span 
class="pcrr7t-">a</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">=&#x003E;</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">foo</span><span 
class="pcrr7t-">:</span><span 
class="pcrr7t-">a</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">&amp;</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">bar</span><span 
class="pcrr7t-">:</span><span 
class="pcrr7t-">a</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">=&#x003E;</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">baz</span><span 
class="pcrr7t-">"</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x67-113005r5"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">daemon</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">watcher</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x67-113006r6"></a></span><span 
class="pcrr7t-">[</span><span 
class="pcrr7t-">tasks</span><span 
class="pcrr7t-">]</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x67-113007r7"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">[[</span><span 
class="pcrr7t-">watcher</span><span 
class="pcrr7t-">]]</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x67-113008r8"></a></span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">#</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">...</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x67-113009r9"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">[[[</span><span 
class="pcrr7t-">outputs</span><span 
class="pcrr7t-">]]]</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x67-113010r10"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">a</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">"</span><span 
class="pcrr7t-">New</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">dataset</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr8c-">$</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">ASYNCID</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">ready</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">for</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">processing</span><span 
class="pcrr7t-">"</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x67-113011r11"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">[[</span><span 
class="pcrr7t-">foo</span><span 
class="pcrr7t-">]]</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x67-113012r12"></a></span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">#</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">...</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x67-113013r13"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">[[[</span><span 
class="pcrr7t-">outputs</span><span 
class="pcrr7t-">]]]</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x67-113014r14"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">a</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">"</span><span 
class="pcrr7t-">Products</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">generated</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">from</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr7t-">dataset</span><span 
class="pcrr7t-">&#x2423;</span><span 
class="pcrr8c-">$</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">ASYNCID</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">"</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x67-113015r15"></a></span><span 
class="pcrro7t-">#</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">...</span>
   
   </div>
<!--l. 3465--><p class="indent" >   If the asynchronous datasets happen to become available in quick succession, entire trees of asynchronous
processing can run in parallel.
</p><!--l. 3468--><p class="noindent" >
</p>
<!--l. 3468--><p class="noindent" ><span class="paragraphHead"><a 
 id="x67-11400010.1.2.1"></a><span 
class="cmbx-10">Repeating Asynchronous Example Suite</span></span>
   See suite <span class="lstinline"><span 
class="pcrr7t-">[</span><span 
class="pcrr7t-">admin</span><span 
class="pcrr7t-">]:</span><span 
class="pcrr7t-">examples</span><span 
class="pcrr7t-">:</span><span 
class="pcrr7t-">async_repeat</span></span>
                                                                                         

                                                                                         
</p>
   <!--l. 3472--><div class="crosslinks"><p class="noindent">[<a 
href="cug-htmlsu45.html" >next</a>] [<a 
href="cug-htmlse10.html" >prev</a>] [<a 
href="cug-htmlse10.html#tailcug-htmlse10.html" >prev-tail</a>] [<a 
href="cug-htmlsu44.html" >front</a>] [<a 
href="cug-htmlse10.html#cug-htmlsu44.html" >up</a>] </p></div>
<!--l. 3472--><p class="indent" >   <a 
 id="tailcug-htmlsu44.html"></a>   </p> 
</body></html> 
